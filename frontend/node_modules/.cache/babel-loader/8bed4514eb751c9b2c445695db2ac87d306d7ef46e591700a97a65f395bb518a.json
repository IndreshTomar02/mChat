{"ast":null,"code":"var _jsxFileName = \"C:\\\\mChat_final\\\\frontend\\\\src\\\\components\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { sendMessage, streamMessage } from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat({\n  token,\n  user,\n  onLogout\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [streaming, setStreaming] = useState(false);\n  const containerRef = useRef();\n  useEffect(() => {\n    var _containerRef$current;\n    (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : _containerRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n  function pushMessage(role, text) {\n    setMessages(m => [...m, {\n      role,\n      text,\n      ts: Date.now()\n    }]);\n  }\n  async function handleSend(e) {\n    e === null || e === void 0 ? void 0 : e.preventDefault();\n    if (!input) return;\n    const msg = input;\n    setInput('');\n    pushMessage('user', msg);\n    setStreaming(true);\n    let buffer = '';\n    const es = streamMessage(token, {\n      input: msg,\n      model: 'gpt-4o-mini'\n    }, chunk => {\n      buffer += chunk;\n      setMessages(m => {\n        const copy = [...m];\n        if (copy.length === 0 || copy[copy.length - 1].role !== 'assistant') copy.push({\n          role: 'assistant',\n          text: chunk,\n          ts: Date.now()\n        });else copy[copy.length - 1].text = (copy[copy.length - 1].text || '') + chunk;\n        return copy;\n      });\n    }, () => {\n      setStreaming(false);\n      sendMessage(token, null, msg).catch(() => {});\n    }, err => {\n      setStreaming(false);\n      pushMessage('assistant', '[stream error]');\n      console.error(err);\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-root\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Nimbus\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 33,\n          columnNumber: 12\n        }, this), \" \\u2014 AI Chat\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: user === null || user === void 0 ? void 0 : user.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onLogout,\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-body\",\n      children: [messages.map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'msg ' + m.role,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"msg-text\",\n          children: m.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 68\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ts\",\n          children: new Date(m.ts).toLocaleTimeString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 40,\n          columnNumber: 108\n        }, this)]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 29\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: containerRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"chat-input\",\n      onSubmit: handleSend,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: input,\n        onChange: e => setInput(e.target.value),\n        placeholder: streaming ? 'Streaming...' : 'Type a message and hit Enter'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: streaming,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 11\n  }, this);\n}\n_s(Chat, \"BgXt6kD1Ul3dW7cPmIH6KBNPcpI=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","sendMessage","streamMessage","jsxDEV","_jsxDEV","Chat","token","user","onLogout","_s","messages","setMessages","input","setInput","streaming","setStreaming","containerRef","_containerRef$current","current","scrollIntoView","behavior","pushMessage","role","text","m","ts","Date","now","handleSend","e","preventDefault","msg","buffer","es","model","chunk","copy","length","push","catch","err","console","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","name","onClick","map","i","toLocaleTimeString","ref","onSubmit","value","onChange","target","placeholder","type","disabled","_c","$RefreshReg$"],"sources":["C:/mChat_final/frontend/src/components/Chat.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { sendMessage, streamMessage } from '../api';\n\nexport default function Chat({ token, user, onLogout }){\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [streaming, setStreaming] = useState(false);\n  const containerRef = useRef();\n  useEffect(()=>{ containerRef.current?.scrollIntoView({ behavior: 'smooth' }); }, [messages]);\n  function pushMessage(role, text){ setMessages(m=>[...m, { role, text, ts: Date.now() }]); }\n  async function handleSend(e){\n    e?.preventDefault();\n    if(!input) return;\n    const msg = input; setInput(''); pushMessage('user', msg);\n    setStreaming(true);\n    let buffer = '';\n    const es = streamMessage(token, { input: msg, model: 'gpt-4o-mini' },\n      (chunk)=>{ buffer += chunk;\n        setMessages(m=>{\n          const copy = [...m];\n          if(copy.length === 0 || copy[copy.length-1].role !== 'assistant') copy.push({ role: 'assistant', text: chunk, ts: Date.now() });\n          else copy[copy.length-1].text = (copy[copy.length-1].text||'') + chunk;\n          return copy;\n        });\n      },\n      ()=>{ setStreaming(false); sendMessage(token,null,msg).catch(()=>{}); },\n      (err)=>{ setStreaming(false); pushMessage('assistant','[stream error]'); console.error(err); }\n    );\n  }\n\n  return (<div className='chat-root'>\n    <div className='chat-header'>\n      <div><strong>Nimbus</strong> â€” AI Chat</div>\n      <div className='header-actions'>\n        <div>{user?.name}</div>\n        <button onClick={onLogout}>Logout</button>\n      </div>\n    </div>\n    <div className='chat-body'>\n      {messages.map((m,i)=>(<div key={i} className={'msg '+m.role}><div className='msg-text'>{m.text}</div><div className='ts'>{new Date(m.ts).toLocaleTimeString()}</div></div>))}\n      <div ref={containerRef} />\n    </div>\n    <form className='chat-input' onSubmit={handleSend}>\n      <input value={input} onChange={e=>setInput(e.target.value)} placeholder={streaming ? 'Streaming...' : 'Type a message and hit Enter'} />\n      <button type='submit' disabled={streaming}>Send</button>\n    </form>\n  </div>);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}